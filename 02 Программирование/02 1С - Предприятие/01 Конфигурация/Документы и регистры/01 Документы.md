[Источник](https://v8.1c.ru/platforma/dokumenty/)

**Документ** — это объект конфигурации, который предназначен для хранения документной информации и для регистрации хозяйственных операций, приходов и расходов товаров

Все документы имеют одинаковую базовую структуру, которая определяется типом `ДокументОбъект`

## Описание типа `ДокументОбъект.<Документ>`

| Свойство                            | Описание                                                                                                                                                                                                                                    |
| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| *`Ссылка`*                          | GUID [[Общая структура объектов конфигурации\|Подробнее]]                                                                                                                                                                                   |
| *`ЭтотОбъект`*                      | Ссылка на текущий объект                                                                                                                                                                                                                    |
| `<ИмяРеквизита>`                    | Нестандартные реквизиты (локальные или общие)                                                                                                                                                                                               |
| `<ИмяТабличнойЧасти>`               | Табличные части                                                                                                                                                                                                                             |
| `Номер`                             | Текстовый или числовой номер документа. Может выступать в роли идентификатора объекта                                                                                                                                                       |
| `Дата`                              | Дата документа                                                                                                                                                                                                                              |
| `Проведен`                          | **`Булево`** Изменение этого параметра вызывает событие `ОбработкаПроведения`                                                                                                                                                               |
| `Представление`                     | **`Строка`**, представляющая объект для пользователя на формах                                                                                                                                                                              |
| `ПометкаУдаления`                   | **`Булево`**                                                                                                                                                                                                                                |
| `МоментВремени`                     | **`МоментВремени`**, позволяющий сравнить документы с одинаковой датой                                                                                                                                                                      |
| `ВерсияДанных`                      | **`Строка`** Версия даннных объекта                                                                                                                                                                                                         |
| `ЗаписьИсторииДанных`               | **`ПараметрыЗаписиИсторииДанных`** Используется для управления записью версии истории данных                                                                                                                                                |
| `Движения`                          | **`КоллекцияДвижений`**                                                                                                                                                                                                                     |
| `ДополнительныеСвойства`            | **`Структура`** Может использоваться в тех случаях, когда необходимо хранить некоторые значения, связанные с объектом, на время выполнения некоторых операций, без изменения объекта. Например, при обработке событий в подписке на события |
| `ОбменДанными`                      | **`ПараметрыОбменаДанными`**                                                                                                                                                                                                                |
| `ПринадлежностьПоследовательностям` | **`ФиксированнаяКоллекция<ПоследовательностьНаборЗаписей.<ИмяПоследовательности>>`** записей последовательностей, в кот. регистрируется документ                                                                                            |

```json
МоментВремени {
	"Дата" : "Дата",
	"Ссылка" : "Ссылка на объект информационной базы",
	"Метод Сравнить(МоментВремени2)" : "если мв1 < мв2, то -1, если мв1 > мв2, то 1, иначе 0"
}
```

Момент времени используется в тех случаях, когда важно различать моменты времени для объектов, имеющих одинаковую дату и время, например для сравнения положений документов на временной оси

| Метод                                                                                | Описание                                                                                                                                                                                                                                                                              |
| ------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Записать()`                                                                         | Выполняет запись объекта в базу данных                                                                                                                                                                                                                                                |
| `Заполнить(данные)`                                                                  | Заполняет данные документа данными из другого объекта. Инициирует событие **`ОбработкаЗаполнения`** и вызов его процедуры-обработчика в модуле документа. Для заполнения может использоваться значение любого типа                                                                    |
| `Заблокировать()`                                                                    | Блокирует объект для других пользователей и блокирует использование других режимов (каких режимов???)                                                                                                                                                                                 |
| `Разблокировать()`                                                                   | Убирает блокировку с объекта                                                                                                                                                                                                                                                          |
| `Заблокирован()`                                                                     | Заблокирован ли объект от изменения другими пользователями                                                                                                                                                                                                                            |
| `Метаданные()`                                                                       | **`ОбъектМетаданных: Документ`**                                                                                                                                                                                                                                                      |
| `Модифицированность()`                                                               | Был ли изменен объект после считывания из базы данных                                                                                                                                                                                                                                 |
| `МоментВремени()`                                                                    | Возвращает **`МоментВремени`** документа, позволяющий сравнить документы с одинаковой датой                                                                                                                                                                                           |
| `ПолучитьМакет()`                                                                    | Возвращает один из макетов документа                                                                                                                                                                                                                                                  |
| `ПолучитьФорму()`                                                                    | Возвращает одну из форм, относящихся к текущему документу                                                                                                                                                                                                                             |
| `ПроверитьЗаполнение()`                                                              | Явно вызывает обработчик проверки заполнения. Для реквизитов, у которых при конфигурировании свойство `"Проверка заполнения"` установлено в значение `"Показывать ошибку"` и реквизит не заполнен, будет сформировано сообщение об ошибке                                             |
| `Прочитать()`                                                                        | Загружает данные в объект из базы данных. Используется, если нужно получить актуальные данные                                                                                                                                                                                         |
| `Скопировать()`                                                                      | Создает экземпляр документа, на основе текущего документа. Использование метода не приводит к записи созданного объекта в базу данных                                                                                                                                                 |
| `Удалить()`                                                                          | Удаление объекта из ИБ без проверки на ссылочную целостность                                                                                                                                                                                                                          |
| `УстановитьВремя(`<br>`[РежимОпределенияВремени],`<br>`[ИспользоватьЖурналы]`<br>`)` | Устанавливает время документа.  <br>При выполнении метода устанавливается привилегированный режим                                                                                                                                                                                     |
| `УстановитьКомментарий`<br>`ВерсииИсторииДанных()`                                   | Не рекомендуется использовать, начиная с версии 8.3.15                                                                                                                                                                                                                                |
| `УстановитьНовыйНомер()`                                                             | Генерирует новый номер и добавляет префикс, если он указан                                                                                                                                                                                                                            |
| `УстановитьПометкуУдаления()`                                                        |                                                                                                                                                                                                                                                                                       |
| `УстановитьСсылкуНового()`                                                           | Устанавливает значение для нового (созданного и еще не записанного) объекта, которое будет назначено при записи в качестве ссылки. Значение не может равняться ссылке какого-либо из имеющихся в базе данных объекта данного типа. Уникальность ссылки проверяется при записи объекта |
| `ПолучитьСсылкуНового()`                                                             | Возвращает ссылку, заданную методом `УстановитьСсылкуНового()`                                                                                                                                                                                                                        |
| `ЭтоНовый()`                                                                         | Определяет записан ли объект в базу данных                                                                                                                                                                                                                                            |

| Событие                                                    | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| *`ПередЗаписью`*                                           | [[Общая структура объектов конфигурации\|Подробнее]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| *`ПриЗаписи`*                                              | [[Общая структура объектов конфигурации\|Подробнее]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| *`ОбработкаЗаполнения`*                                    | [[Общая структура объектов конфигурации\|Подробнее]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| *`ОбработкаПроверкиЗаполнения`*                            | [[Общая структура объектов конфигурации\|Подробнее]] Вызывается в форме при необходимости проверки заполнения реквизитов при записи или при проведении документа в форме, а также при выполнении метода `ПроверитьЗаполнение`. <br>Если для документа при конфигурировании свойство `Проведение` установлено в `Разрешить`, то вызывается только при проведении; если установлено `Запретить`, то вызывается при записи.<br>Позволяет разработчику конфигурации самостоятельно реализовать проверку заполнения в обработчике события. При этом в обработчике можно полностью отказаться от системной обработки (очистив список проверяемых реквизитов), отказаться от проверки системой части реквизитов (выполнив проверку отдельных реквизитов особенным образом и исключив эти реквизиты из списка), а также добавить для проверки другие реквизиты, проверка которых не была указана |
| **`ПередУдалением`**                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`ПриКопировании`**                                       | При выполнении метода `Скопировать()`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **`ПриУстановкеНовогоНомера`**                             | Активируется в начале генерации нового номера. Позволяет отключать автоматическую генерацию номера и опционально добавить префикс (если номер является строкой). Безопасный режим на время исполнения данного обработчика будет отключен. Данное замечание не относится к обработчикам событий, расположенным в расширении конфигурации                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`ОбработкаПроведения`**                                  | Активируется перед проведением документа. Позволяет отключить стандартную обработку и задать режим проведения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **`ОбработкаУдаленияПроведения`**                          | Активируется перед отменой проведения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **`ОбработкаФормирования`**<br>**`ПоВерсииИсторииДанных`** | Возникает при формировании объекта по версии истории данных                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

## Метаданные документов (Конфигуратор)

Далее рассматриваются разделы панели свойств документа

### Нумерация

| Параметр              | Описание                                                        |
| --------------------- | --------------------------------------------------------------- |
| Автонумерация         | **`Булево`**                                                    |
| Нумератор             | Ссылка на объект конфигурации Нумератор                         |
| Длина номера          | Максимальное количество символов в номере (независимо от типа)  |
| Контроль уникальности | **`Булево`**                                                    |
| Тип номера            | `{ Число, Строка }`                                             |
| Периодичность         | Определяет, в рамках какого периода будет выполняться нумерация |

*Периодичность* может принимать следующие значения:

- Непериодический
- В пределах года
- В пределах квартала
- В **пределах** месяца
- В пределах дня


### Поле ввода

| Параметр                      | Описание                                                                                                                                                                                |
| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| СозданиеПриВводе              | `{ Использовать, Не использовать }` Определяет доступно ли создание нового объекта из выпадающего списка предложений для поля ввода (событие поля ввода на форме **`Создание`**)        |
| Ввод по строке                | Реквизиты, по которым может осуществляться поиск объектов. Пользователь может вводить часть значения реквизита и получать предложения объектов, у которых совпадают значения реквизитов |
| Способ поиска строки          | `{ Начало, Любая часть }`                                                                                                                                                               |
| Полнотекстовый поиск          | `{ Использовать, Не использовать }`                                                                                                                                                     |
| Режим получения данных выбора | `{ Непосредственно, Фоновый }`                                                                                                                                                          |
| История выбора при вводе      | `{ Авто, Не использовать }` Определяет будет ли использоваться история выбора документов как реквизитов в других объектах конфигурации (история выбора на формах)                       |

### Создание при вводе

Если документ находится на форме как элемент формы (поле ввода), то по умолчанию пользователь может видеть историю выбора в виде выпадающего списка. В выпадающем списке также есть кнопка создания нового документа. При этом можно как скрывать эту кнопку, так и обрабатывать, соответствует ли создаваемый документ заданным условиям выбора.

```bsl
&НаКлиенте
Процедура СкладСоздание(Элемент, СтандартнаяОбработка)

    НовыйПараметр = Новый ПараметрВыбора("Отбор.Розничный", Ложь);
    НовыйМассив = Новый Массив();
    НовыйМассив.Добавить(НовыйПараметр);
    НовыеПараметры = Новый ФиксированныйМассив(НовыйМассив);
    Элементы.Склад.ПараметрыВыбора = НовыеПараметры;

КонецПроцедуры
```

Эта возможность задается с помощью свойства СозданиеПриВводе у прикладных объектов конфигурации (справочников, документов и т. п.), ссылочных реквизитов объектов конфигурации, измерений, ресурсов и др. У элементов формы, отображающих данные ссылочных реквизитов, это свойство называется КнопкаСоздания.

Если на всех «уровнях» иерархии (начиная от поля ввода до прикладного объекта) создание новых элементов данных при вводе в ссылочное поле разрешено, то в выпадающем списке у поля будет присутствовать кнопка создания – с пиктограммой «+». С ее помощью пользователь может создавать новые элементы данных в форме прикладного объекта и сразу же подставлять их в поле ввода, не открывая при этом форму выбора (рис. 3.205).

![[1С_8336.png]]

Например, пользователь может сразу начинать ввод наименования нового поставщика в ссылочном поле Поставщик. Убедившись, что соответствия с новым значением не найдено, он может нажать кнопку создания в выпадающем списке, открывшемся под этим полем. Появится форма нового элемента справочника Поставщики, при этом введенные в поле ввода символы уже будут подставлены в наименование нового элемента. Пользователю останется только нажать кнопку Записать и закрыть, и ссылка на нового поставщика будет подставлена в поле ввода

![[1С_8337.png]]

Таким образом существенно повышаются комфортность и скорость работы пользователей с прикладным решением.

Однако надо учитывать, что пользователь может создать такой элемент данных, который, вообще говоря, не должен оказаться в ссылочном поле. Например, если он не соответствует условиям отбора, которые заданы в свойствах СвязиПараметровВыбора или ПараметрыВыбора этого поля.

Поэтому перед подстановкой нового элемента в ссылочное поле он автоматически проверяется на соответствие параметрам выбора и связям параметров выбора, установленным для этого поля. И если элемент не соответствует условиям отбора, то будет выдано диагностическое сообщение об этом и созданный элемент не будет помещен в поле ввода.

Разработчик может программно вмешаться в процесс проверки, отменить ее или изменить условия проверки и т. д. Для этого в платформе реализован следующий механизм.

При нажатии кнопки создания в выпадающем списке у ссылочного поля возникает событие Создание. В обработчике этого события разработчик может изменить или дополнить условия выбора, заданные в свойствах СвязиПараметровВыбора или ПараметрыВыбора этого поля. Причем он может описать и дополнительные условия выбора, имена которых начинается с префикса «Дополнительно.».

По умолчанию параметр СтандартнаяОбработка события Создание установлен в значение Истина. В этом случае платформа выполнит открытие основной формы объекта в режиме выбора, при этом для осуществления проверки в форму будут переданы параметры:

- ПараметрыВыбора. Эта структура содержит параметры выбора, ограничивающие список элементов, которые могут быть выбраны в поле ввода. Заполняется из параметров выбора и связей параметров выбора. В структуру попадают только те значения, имена которых начинаются с префикса «Отбор.»;
- ДополнительныеПараметры. Эта структура содержит дополнительные параметры, которые разработчик считает нужным передать в форму объекта. Заполняется из параметров выбора и связей параметров выбора. В структуру попадают только те значения, имена которых начинаются с префикса «Дополнительно.».

Владельцем открываемой формы нового объекта будет выступать поле ввода, откуда вызвано создание объекта.

При открытии формы нового объекта значение параметра формы ПараметрыВыбора копируется в одноименное свойство формы. Таким образом, условия отбора выбираемых элементов будут нам доступны через свойство ПараметрыВыбора в течение всей «жизни» формы.

А вот условия, содержащиеся в параметре ДополнительныеПараметры, будут доступны только в обработчике события ПриСозданииНаСервере(), как и все остальные неключевые параметры. Поэтому, если требуется использовать их где-то еще (например, проанализировать их на предмет подстановки созданного значения в поле ввода), нужно сохранять эти условия в специальном реквизите формы.

В момент закрытия формы (после вызова события ПередЗакрытием и перед вызовом события ПриЗакрытии) у формы вызывается событие ВыборЗначения. В обработчике этого события разработчик может выполнить дополнительные проверки или повлиять на результат автоматической проверки с помощью значения свойства ВыборДоступен:

- Если свойство ВыборДоступен установлено в значение Истина, то проверка успешно пройдена и выполняется выбор созданного элемента.
- Если свойство ВыборДоступен установлено в значение Ложь, то формируется сообщение о том, что созданный элемент не соответствует условиям выбора, и выбор созданного элемента не выполняется.

В случае если разработчик хочет самостоятельно выполнить проверку, выдать собственное диагностическое сообщение, поместить значение в поле ввода и т. д., нужно установить параметр СтандартнаяОбработка события ВыборЗначения в значение Ложь

## Движения

> **Движения документа** – это записи в специальных объектах конфигурации — **[[03 Регистры накопления|регистрах]]**. Записи регистра создаются при проведении документа и отражают изменения, производимые документом

Движения документов формируются в модуле объекта, в обработчике проведения, но можно использовать **конструктор движений**

> При повторном проведении документа новых движений создано не будет, вместо этого будут обновлены существующие движения

Вкладка "Движения" в свойствах документа, задаваемых в конфигураторе:

| Параметр              | Описание                                          |
| --------------------- | ------------------------------------------------- |
| Проведение            | `{ Разрешить, Запретить }`                        |
| Оперативное поведение | `{ Разрешить, Запретить }`                        |
| Удаление движений     | (автоматическое или нет)                          |
| Контроль уникальности | **`Булево`**                                      |
| Конструктор движений  | Позволяет формировать движения без написания кода |

> Документ может связан с несколькими регистрами одновременно и при проведении они все будут пополняться

Если в регистр при проведении записываются свойства других объектов базы данных, на которые ссылается документ, то будет сформирован внутренний запрос на получение затрагиваемых объектов целиком, поэтому при обращении к сторонним объектам, следует явно формировать запрос для оптимизированного получения данных.

>Один документ может делать сразу несколько движений в разные регистры

> При пометке на удаление документ отменяет проведение, что удаляет связанные движения

## Последовательности

https://42clouds.com/ru-ru/manuals/posledovatelnost-dokumentov-v-1s/
## Нумераторы

Нумераторы — это прикладные объекты конфигурации. Использование нумераторов позволяет организовать сквозную нумерацию документов разных видов. Для этого всем таким документам назначается один нумератор. Контроль уникальности и присвоение нового номера будет выполняться с учетом всех документов, для которых назначен этот нумератор.

#1С #1С/Конфигурация/Регистры #1С/Конфигурация/Документы