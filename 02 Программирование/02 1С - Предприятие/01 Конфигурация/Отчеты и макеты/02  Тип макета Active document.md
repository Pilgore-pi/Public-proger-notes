Представляет собой документ форматов Mircrosoft (Word, Excel, PowerPoint). Сам файл макета является внешним (независимым от системы 1С). При создании макета этого типа внутри среды 1С открывается интерфейс Word, Excel или PowerPoint. Для управления макета используется API, который использует COM-объекты (`COMОбъект`).

## COM объект

[[05 Component Object Model (COM)|COM-объекты]] позволяют 1С взаимодействовать с различными внешними приложениями, такими как Microsoft Office (Excel, Word), Internet Explorer, и другими программами, поддерживающими COM.

```
// тип макета = "ОболочкаActiveDocument"
макет = Документы.МойДокумент.ПолучитьМакет("ПростойWord");

WordDoc = макет.Получить(); //COM object, API инструментарий для работы с Word

// Скрытие редактора Word
WordDoc.Application.Visible = ложь;

// Открытие созданного макета в приложении Word
doc = wordDoc.Application.Documents(1);
doc.Activate();

// Операции с документом...

wordDoc.Application.Visible = истина;
```

Параметры в документе Word

Чтобы задать параметры в документе Word, можно использовать "закладки" (Главное меню > Вставка > Закладка). Чтобы добавить закладку, нужно выделить нужный текст и задать имя закладки.
По умолчанию закладки никак не выделяются. Чтобы добавить отображение закладок, нужно перейти в Главное меню > Файл > Параметры > Дополнительно > Показывать закладки. Настройки лучше менять в независимом приложении Word, а не внутри 1С.

```
// Находим закладку по имени и выделяем ее
wordDoc.Bookmarks("МояЗакладкаКакПараметр").Select();

// Ввод текста вместо выделения
wordDoc.Application.Selection.TypeText(желаемоеЗначение);
```

Прямого способа задавать параметры нет. Можно использовать любой доступный функционал для обращения к нужным элементам документа. Например, можно заменить строку на значение параметра, но для этого заменяемая строка должна быть однозначно распознана как параметр. Для этого можно использовать спец. символы, чтобы не запутаться ( `{имяПараметра}`, `<ИМЯ ПАРАМЕТРА>`, `***имя_параметра***` )

**Работа с таблицами**

```
// получение первой таблицы 
таблица = wordDoc.Tables.Item(1);
номерСтроки = 1;
пока какаяТоВыборкаДанных цикл
```

[Продолжение](https://youtu.be/_gZ-8JTl948?t=7463)

[[01 COM в 1С|COM Соединения]]

#1С #COM #1С/Конфигурация/Макеты