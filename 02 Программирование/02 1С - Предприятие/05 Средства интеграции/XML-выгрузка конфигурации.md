
Конфигурация может быть выгружена 3 способами:

- Единым `.cf`/`.cfu` файлом (конфигурация и расширение конфигурации)
- Множеством файлов (каталоги, `.bin`, `.xml`, `.bsl`, `.cf`)
- Множеством файлов, упакованных в ZIP-архив

## Особенности конфигурации 1С

#### Что хранится в конфигурации

- Структура объектов конфигурации (справочники, регистры, перечисления...)
- Код всех модулей
- Параметры всех объектов метаданных и всей конфигурации
- Структура и свойства подчиненных объектов метаданных (реквизиты, табличные части, формы)

#### Объектные и необъектные типы

Объекты метаданных имеют 2 вида:

- **Объектные типы**: ссылочный тип, идентифицируемый GUID-значением. Даже при удалении и создании нового объекта с одним и тем же GUID, система не обнаружит подмены.
    - значение GUID хранится в специальном свойстве "Ссылка"

- **Необъектные типы**: объекты, у которых нет специального ID, идентификация происходит по совокупности значений объекта

- Таблица объектных и необъектных типов

| Объектные типы         | Необъектные типы   |
| ---------------------- | ------------------ |
| Справочники            | Все типы регистров |
| Документы и журналы    |                    |
| Перечисления           |                    |
| Планы выдов..., счетов |                    |
| Задачи                 |                    |
| Бизнес-процессы        |                    |

#### Инкрементальная выгрузка и загрузка

Позволяет сократить обновление и выгрузку конфигурации, за счет того, что происходит загрузка и выгрузка только новых или измененных файлов.

**Команда инктрементальной выгрузки** в XML-файлы:

```batch
<путь_к_приложению> config /DumpConfigToFiles <путь_к_каталогу_выгрузки> -update
```

```batch
1cv8.exe config /DumpConfigToFiles C:/Conf -update
```

флаг `-update` активирует режим инкрементальной выгрузки

> Путь к каталогу выгрузки должен иметь длину не более 30 символов

**Скрипт выгрузки логов изменений**:

```batch
1cv8.exe config /DumpConfigToFiles C:\xml -getChanges C:\diff.txt
```

**Скрипт выгрузки "патча", который хранит только новые и измененные файлы конфигурации**:

```batch
1cv8.exe config /DumpConfigToFiles C:\xml_patch -update –configDumpInfoForChanges C:\xml_source\ConfigDumpInfo.xml
```

- **`C:\xml_source\ConfigDumpInfo.xml`** — это файл версий основной конфигурации

- **`C:\xml_patch`** – каталог, в который будут выгружены файлы изменений

- **`ConfigDumpInfoForChanges`** — это ключ, который позволяет указать конкретный файл версий, от которого нужно «отсчитывать» изменения.

## Структура выгрузки

> Выгрузка конфигурации инорирует все используемые расширения

#### `[ConfigDumpInfo.xml]`

*Данный файл может отсутствовать*

Информация о формате выгрузки, версии конфигурации и версиях всех выгруженных объектов метаданных.

#### `Configuration.xml`

- Свойства объекта метаданных "Конфигурация"
- Используемый язык
- Названия всех объектов метаданных

#### Каталоги типов объектов конфигурации

Для каждого типа объектов конфигурации (справочники (`Catalogs`), перечисления (`Enums`), документы (`Documents`), роли (`Roles`) и т.д.) создается каталог с английским названием типа, но только в том случае, если есть хотя бы 1 представитель данного типа

#### Каталог "Ext"

- Каталог "Logo"
- Каталог "Splash"
- Каталог "ParentConfigurations" — список родительских конфигураций
    - `.cf` файлы
- `Logo.xml`
- `Splash.xml`
- `ParentConfigurations.bin` — (текст) информация о родительских конфигурациях с кучей GUID-ов
- `ClientApplicationInterface.xml` — конфигурация панелей интерфейса клиентского приложения
- `CommandInterface.xml` — структура командного интерфейса и порядок подсистем
- `HomePageWorkArea.xml` — конфигурация рабочей области
- `SessionModule.bsl` — модуль сеанса
- `ExternalConnectionModule.bsl` — модуль внешнего соединения
- `OrdinaryApplicationModule.bsl` — модуль "обычного" приложения
- `ManagedApplicationModule.bsl` — модуль "управляемого" приложения

## Структура 1 объекта метаданных

#### Каталог "\<Тип\_объекта\_метаданных\>"

- `<Пользовательский_тип_объекта_метаданных>.xml`
- `[Каталог "<Пользовательский_тип_объекта_метаданных>"]`: *(может отсутствовать)* хранит данные подчиненных объектов конфигурации (макеты, команды, формы, модули менеджера и объекта)
    - `[Каталог "Ext"]`: *(может отсутствовать)* содержит код модулей менеджера и объекта
    - <span style="color:#A90;">[Каталог "Templates"]</span>: *(существует только при наличии макетов)* информация о макетах
        - `<Имя_макета>.xml`
        - `Каталог "<Имя_макета>"`
            - `Каталог "Ext"`
                - `Template.xml`
    - <span style="color:#0AC;">[Каталог "Forms"]</span>: *(существует только при наличии форм)*
        - `<Имя_формы>.xml`
        - `Каталог "<Имя_формы>"`
            - `Каталог "Ext"`
                - `Form.xml` — **разметка формы**
                - `Каталог "Form"`
                    - `Module.bsl`

#1С #1С/Конфигурация #1С/Язык_программирования/Сериализация/XDTO #XML #API #Administration