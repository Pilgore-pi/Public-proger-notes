1С Поддерживает подключение и запуск внешних программ. Объект **`ВнешняяКомпонента`**

## Внедрение внешних программ в конфигурацию

Допустим, у вас есть готовая скомпилированная программа, которая представлена единственным файлом. Тогда эту программу можно загрузить в двоичный макет любого объекта конфигурации.

Алгоритм действий:

1. Создать макет с типом "Двоичные данные"
2. Загрузить данные из файла, представляющего скомпилированную программу
3. Написать обработчик команды выполнения программы. Команда должна записать содержимое макета на диск как исполняемый файл и запустить его

Обработчик команды запуска внешней программы

```bsl
&НаКлиенте
Процедура Команда1(Команда)
	КомандаНаСервере();
КонецПроцедуры

Процедура КомандаНаСервере()
    
    путь = "C:\Andrey\IT\test1.exe";
	ЭтаОбработка = РеквизитФормыВЗначение("Объект");
	
	МакетEXE = ЭтаОбработка.ПолучитьМакет("ExternalExecutable");
	МакетEXE.Записать(путь);
	файлик = новый файл(путь);
	
	Если НЕ файлик.Существует() Тогда
		Сообщить("ЕГО НЕТ!");
		Возврат;
	КонецЕсли;
	
	ЗапуститьПриложение(путь);
    
КонецПроцедуры
```

В качестве алтернативы, можно в макетах хранить не готовую программу, а код программы, для последующего исполнения. Это сильно экономит память, но создает зависимость от наличия среды выполнения кода

Важно учитывать следующие негативные моменты:

- Внешние программы являются серьезным источником угроз безопасности
- Скомпилированная программа, обычно, имеет большой вес, даже, если программа очень простая. По этой причине, необходимо проводить оптимизацию сборки стороннего приложения или менять инструменты разработки, если существует такая возможность

Можно внедрять как самодостаточные приложения (Self-contained) в конфигурацию, так и облегченные, нативные приложения. Различия подходов:


| Характеристика | Самодостаточное приложение                                     | Нативное приложение |
| -------------- | -------------------------------------------------------------- | ------------------- |
| Вес файла      | Большой вес из-за необходимости хранения среды выполнения кода | Небольшой вес       |
| Безопасность   | Низкая                                                         | Низкая              |
|                |                                                                |                     |

Даже, если мы будет компилировать нативное приложение с маленьким весом, оно все равно может весить несколько мегабайт, так как в программе могут содержаться дополнительные данные, например, для поддержки кроссплатформенности. По этой причине, следует выбирать самые оптимизированные программы, так как одно большое приложение, обычно, весит значительно меньше, чем несколько маленьких приложений, так в большом приложении у всех подмодулей общие зависимости, которые не нужно определять повторно

#1С #1С/Интеграция