`Span<T>` — это ref-структура, которая представляет собой непрерывную область памяти на стеке. Span позволяет увеличить производительность и уменьшить расход памяти.

Фактически Span представляет собой коллекцию ссылок на данные типа `T`.
Элементы этой коллекции изменять можно.

`Span<T>` не может размещаться в куче. Попытка создать Span-поле произойдет ошибка на этапе компиляции.
Создавать Span-поля можно только в ref-структурах.

## ref struct

```csharp
public readonly ref struct Span<T>{...}
```

ref-структуры не могут:

- быть элементом массива
- быть объявлены в классах и не ref-структурах
- реализовывать интерфейсы
- быть упакованы
- быть ***захвачены*** лямбдой или локальной функцией
- использоваться в `async`-методах
- использоваться в итераторах и в операторе `yield`

Однако ref-структуры можно объявлять внутри методов.

## readonly struct

особенности readonly-структур:
- члены структуры являются `readonly`
- свойства не могут иметь сеттеры
- структура неизменяема
- изменение значений членов через ссылку `this` вне конструктора приведет к ошибке

### Зачем нужны?

Span позволяет не выделять дополнительную память и, соответственно, избежать процесса сборки мусора. Пока работает сборка мусора, программа не выполняется.

Когда есть возможность использования данной структуры, нужно ее использовать, так как это значительно уменьшает расходы памяти и времени выполнения.

Так как Span — это массив ссылок, то его изменения приведут к изменению источника данных, на который указывает Span.

## `ReadonlySpan<T>`

Представляет собой `Span<T>`, элементы которого неизменяемы.

## Методы `Span<T>`

1. `Clear()`
2. `CopyTo(Span<T>)`
3. `TryCopyTo(Span<T>)`
4. `Slice(int start, int length)` — срез спана, начиная с указанной позиции и указанной длины

#Performance