Анонимные типы в C# позволяют создавать объекты без явного определения их типа. Это полезно, когда нужно быстро создать объект для временного использования, например, для передачи данных между методами или для работы с LINQ-запросами [[01 Введение в LINQ]].

```cs
var user = new { Name = "Tom", Age = 34 };
Console.WriteLine("user type is " + user.GetType());
```

Вывод:

```
user type is <>f__AnonymousType0`2[System.String,System.Int32]
```

Для анонимных типов имя создается автоматически компилятором и далее, при необходимости, используется им.

Анонимные типы являются ссылочными.

Если в программе используются несколько объектов анонимных типов с одинаковым набором свойств, то для них компилятор создаст одно определение анонимного типа:
```cs
var user = new { Name = "Tom", Age = 34 };
var student = new { Name = "Alice", Age = 21 };
var manager = new { Name = "Bob", Age = 26, Company = "Microsoft" };
 
Console.WriteLine(user.GetType().Name); // <>f__AnonymousType0'2
Console.WriteLine(student.GetType().Name); // <>f__AnonymousType0'2
Console.WriteLine(manager.GetType().Name); // <>f__AnonymousType1'3
```
Cвойства анонимного объекта доступны для установки только в инициализаторе, далее изменить их будет нельзя.

### Особенности анонимных типов

1. **Неизменяемость**: Свойства анонимных типов являются только для чтения. Это значит, что после создания объекта изменить значения его свойств нельзя.

2. **Вывод типов**: Компилятор автоматически выводит типы свойств на основе присвоенных значений. В примере выше, `Name` будет строкой (`string`), а `Age` — целым числом (`int`).
 
3. **Сравнение**: Анонимные типы переопределяют методы `Equals` и `GetHashCode`, что позволяет сравнивать объекты по значению их свойств.
  
4. **Сокрытие типов**: Тип анонимного объекта не имеет имени, поэтому его нельзя явно указать в коде. Вместо этого используется `var`.

5. **Область видимости**: Анонимные типы доступны только в пределах метода, где они созданы. Нельзя вернуть анонимный тип из метода или передать его в качестве параметра.

6. **Отсутствие методов**: Анонимные типы не могут содержать методов, только свойства.

## Инициализаторы с проекцией

```cs
Person tom = new Person("Tom"); 
int age = 34;
var student = new { tom.Name, age }; // инициализатор с проекцией
Console.WriteLine(student.Name);
Console.WriteLine(student.age);
```

Можно передать в инициализатор некоторые идиентификаторы, имена которых будут использоваться как названия свойств

Можно объявлять массивы анонимных типов:

```cs
var people = new[]
{
    new { Name="Tom" },
    new { Name="Bob" }
};
```

#C-Sharp #OOP #C-Sharp/OOP/Anonymous_type