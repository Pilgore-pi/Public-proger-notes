MS SQL:
- `select scope_identity()`, чтобы получить последний созданный id в текущем соединении и только текущей области видимости (триггеры и функции игнорируются).
- `select @@identity`, чтобы получить последний созданный id на текущем соединении независимо от области видимости (триггеры и функции учитываются).
- `select ident_curent(‘tablename’)`, чтобы получить последний id на конкретной таблице, созданные на любом соединении.

## Приложение OUTPUT

Команды INSERT, DELETE, UPDATE и MERGE могут содержать приложение OUTPUT. OUTPUT возвращает данные из строк (записей), изменившихся в результате выполнения перечисленных инструкций.
Команда INSERT может содержать подкоманду OUTPUT, которая может вернуть различные данные.
Возвращает все удаленные записи:
```sql
DELETE Sales.ShoppingCartItem OUTPUT DELETED.*;
```
Можно явно указывать столбец с префиксами INSERTED или DELETED (INSERTED.col_name)
```sql
INSERT INTO _table (...)
OUTPUT INSERTED.IDENTITYCOL
VALUES (...)
```
Инструкция OUTPUT не поддерживается для:
* Инструкций DML, которые содержат ссылки на локальные секционированные представления, распределенные секционированные представления или удаленные таблицы. (Фиг знает, что это значит)
* Инструкций INSERT, содержащих инструкции EXECUTE.

(существуют и другие ограничения)

Другой источник:
```sql
INSERT INTO _table (...)
OUTPUT INSERTED.ID
VALUES(...);
```

#DB #SQL