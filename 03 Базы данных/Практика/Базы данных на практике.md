Здесь будет описано, как использовать базу данных MSSQL в проекте реализованном на языке C#. Преимущество MSSQL состоит в том, что данная система позволяет не использовать дополнительных программ для управления базами данных. Управление базой данных будет производится с помощью среды Visual Studio.

#### Создание проекта

Тип проекта не принципиален.

## Создание файла базы данных

Добавляем элемент в наш проект.

![[MS_SQL_02.png]]
Выбираем вкладку _**Данные**_, затем выбираем "База данных, основанная на службах"

>Любая база данных имеет строку подключения, которая позволяет приложениям пользоваться базой данных

## Добавление строки подключения в конфигурационный файл приложения

1. Нужно скопировать строку подключения созданной БД. Для этого нужно открыть ее свойства и найти свойство "строка подключения".
2. Нужно открыть/создать конфигурационный файл приложения App.config. Файл представляет собой XML-код. Нужно внутри тега "configuration" создать тег "connectionStrings", в нем еще один тег "add". У тега "add" нужно задать свойства "name" (любое) и "connectionString".

## Добавление необходимых пространств имен

Необходимо подключить пространства имен: System.Configuration, System.Data, System.Data.SqlClient, для этого нужно в ссылках проекта добавить ссылку "System.Configuration".

## Использование базы данных в коде

Класс SqlConnection предоставляет необходимый функционал для работы с базой данных. Создадим в коде переменную SqlConnection и при загрузке окна будем инициализировать ее:

```cs
private void Window_Loaded(object sender, RoutedEventArgs e)
{
	sqlCon = new SqlConnection(
		ConfigurationManager.
		ConnectionStrings["ConString"].
		ConnectionString
	);
}
```

ConnectionStrings -- это определенный нами тег, представляющий словарь. По установленному нами имени получаем нужную нам строку подключения.

## Открытие подключения к БД

Чтобы открыть подключение нужно ввести:
```cs
sqlCon.Open();
```

## Создание таблицы

Обновим нашу базу данных, нажав в контекстном меню "Обновить". Значок крестика должен смениться.
Чтобы создать таблицу, нужно открыть нашу БД в обозревателе серверов, выбрать папку "Таблицы", затем "Добавить новую таблицу". Откроется Конструктор таблиц, в котором можно делать SQL-запросы.

![[MS_SQL_03.png]]

В первой колонке "Имя" определяются имена атрибутов (столбцов) для нашей таблицы. По умолчанию уже предопределен один атрибут -- "id".
Чтобы организовать автоматический инкремент числового id, нужно нажав на ключик открыть его свойства. Во вкладке "Спецификация идентификатора" у свойства "(Идентификатор)" нужно задать значение True.

* При изменении характеристик таблицы будет меняться SQL-код в нижнем окне.

>Именование атрибутов должно быть на латиннице без пробелов.

Для текстовой информации, поддерживающей русские символы нужно использовать тип _**nvarchar**_. В скобках указывается максимальное количество символов для переменной атрибута.

## Именование таблицы

Чтобы задать имя для таблицы, нужно после оператора CREATE TABLE в квадратных скобках написать желаемое имя.

![[MS_SQL_04.png]]

Чтобы сохранить проделанные изменения, нужно нажать "Обновить".
Теперь можно снова обновить подключение, нажав на значок базы данных, чтобы новая таблица отобразилась в обозревателе серверов.

## Другой способ создания таблицы

Мы создали таблицу во встроенном конструкторе. Вместо этого можно сделать запрос. Для этого нужно открыть контекстное меню, нажав на значок нашей БД, и нажать "новый запрос". Откроется миниредактор SQL команд. Чтобы запустить скрипт, нужно нажать на зеленую стрелку.

[Источник](https://www.youtube.com/playlist?list=PLH3y3SWteZd1oBVuI7mIGsk5psiCb4teB) [[Создание SQL запросов]]

#DB #SQL/MSSQL #C-Sharp