**Рассмотреть:**

- Team Viewer и подобные приложения
- Active directory
- WMI: механизм Windows по удаленному управлению компонентами ОС 
- PSExec
- WinRM (Powershell Remoting)

## PsExec

> PsExec - это бесплатная утилита командной строки, с помощью нее можно запускать программы на удаленных Windows системах, перенаправляя данные, которые выводится приложением на экран на локальный ПК. Т.е. при работе с этой утилитой складывается ощущение, что приложение работает локально на вашем ПК

Можно использовать графическую оболочку *Rinstall*

- Некоторые сканеры антивирусной защиты сообщают о том, что один или несколько средств заражены вирусом удаленного администратора. Ни один из psTools не содержит вирусов, но они использовались вирусами, поэтому они активируют уведомления о вирусах

Удобство PsExec в том, что ее легко развернуть в сети благодаря возможности удаленной установки, без необходимости устанавливать или настраивать что-либо на каждом. На удаленном ПК PsExec работает в виде службы Windows с таким же именем.

Для удаленного запуска команд и процессов необходимо следующее:

- удаленном и локальном ПК должны функционировать службы «Сервер» и «Рабочая станция» (Workstation и Server)
- на удаленном компьютере должен быть доступен стандартный общий ресурс `Admin$`

Устанавливать ее не нужно, можно просто скопировать ее в каталог, определенный в переменной %path% (PATH) (например, C:WindowsSystem32). При запуске команд через PsExec на удаленном ПК запустится служба PsExec (исполняемый файл system32psexesvc.exe), соответственно для нормальной работы вам понадобятся права администратора домена на удаленной машине. Формат запуска и параметры командной строки у утилиты PsExec следующие:

```batch
psexec [computer[,computer2[,…] | @file][-u user [-p psswd]][-n s][-l][-s|-e][-x][-i [session]][-c [-f|-v]][-w directory][-d][-<priority>][-a n,n,… ] cmd [arguments]
```

В принципе эту утилиту можно рассматривать как альтернативу telnet

В том случае, если имя пользователя и пароль не указаны, используются права текущего пользователя:

```batch
psexec buh_pc1 cmd.exe

psexec buh_pc1 -u admin -p P@ssw0rd notepad.exe
```

Если вам понадобится запустить определенную команду на нескольких компьютерах одновременно (например, shutdown –f –r –t 0 ☺), то их имена или ip-адреса нужно перечислить через запятую, или же поместить в текстовый файл, который выбрать в качестве одного их параметров утилиты PsExec..

```batch
psexec buh_pc1, buh_pc2 shutdown –f –r –t 0

psexec @c:list_of_buh_pc.txt shutdown –f –r –t 0
```

При использовании ключа “-c” указанная программа сначала скопируется с вашего ПК на удаленный, а потом выполнится. Ключ “-i” заставляет указанную команду запустится в интерактивном режиме. Если вы хотите, чтобы после запуска определенной команды PsExec не ждал ее окончания, а вывернул вам управление (командную строку), нужно указать параметр “-d”:

```batch
psexec -d buh_pc1 chkdsk
```

Эта команда запустит на удаленной системе процесс проверки диска, а администратор сможет продолжить введение команд.

## PowerShell WinRM (Windows, Linux, macOS)

Перед тем как использовать PowerShell Remoting, необходимо убедиться, что служба WinRM включена на всех целевых компьютерах. Для этого выполните следующую команду в PowerShell с правами администратора:

```PowerShell
Enable-PSRemoting -Force
```

Эта команда активирует WinRM и настраивает необходимые параметры для удаленного управления.

Убедитесь, что служба WinRM работает:

```powershell
Get-Service winrm
```

Если служба не запущена, вы можете запустить её командой:

```powershell
Start-Service winrm
```

## Active directory (В основном Windows Server)

 > Active directory (AD) - механизм администрирования в корпоративной сети от компании Microsoft позволяющий объединить различные объекты сети (компьютеры, серверы, принтеры, различные сервисы) в единую систему. В данном случае AD выступают в роли каталога (базы данных), в котором хранится информация о пользователях, ПК, серверах, сетевых и периферийных устройствах.

- Данная технология предоставляет специальную систему информационной защиты

Поддержка ОС:

Поддерживается преимущественно в операционных системах семейства *Windows Server*. Есть возможность интеграции с Unix системами, но для этого требуются специальные решения (LDAP-клиенты, Samba 4, UNAB...)

Для использования AD необходим *специальный сервер - контроллер домена*. Именно он будет выполнять функции аутентификации пользователей и устройств в сети, а также выступать в качестве хранилища базы данных. При попытке использовать любой из объектов (ПК, сервер, принтер) сети, выполняется обращение к контроллеру домена, который либо разрешает это действие (есть необходимые права), либо блокирует его.

При авторизации все компьютеры обращаются к этой базе данных, благодаря чему вносимые изменения будут применены ко всем компьютерам сети.  Также с помощью AD реализуются политики безопасности, благодаря котором можно ограничить (либо разрешить) доступ к определенным серверам.

Пользователей можно объединять в группы, для которой будут определены общие настройки. Это упрощает добавление пользователя в группу, так как он автоматически получает все настройки группы

## Configuration manager (Только Windows)

[Документация 1](https://learn.microsoft.com/ru-ru/mem/configmgr/core/understand/introduction)
[Документация 2](https://learn.microsoft.com/en-us/mem/configmgr/core/clients/deploy/configure-wake-on-lan)

> Configuration Manager - 

- Позволяет использовать функционал Wake-on-LAN для пробуждения спящих компьютеров
- Поддерживается отправка уведомлений через клиентский канал

Configuration Manager расширяет возможности и работает вместе со многими технологиями и решениями Майкрософт. Например, Configuration Manager интегрируется с:

- Microsoft Intune для совместного управления различными платформами мобильных устройств
- Microsoft Azure для размещения облачных служб для расширения служб управления
- Windows Server Update Services (WSUS) для управления обновлениями программного обеспечения
- Службы сертификации
- Exchange Server и Exchange Online
- Групповая политика
- DNS
- Пакет автоматического развертывания Windows (Windows ADK) и средство миграции пользовательской среды (USMT)
- Службы развертывания Windows (WDS)
- Удаленный рабочий стол и удаленный помощник

## WMI (Только Windows)

WMI — это большой механизм Windows по удаленному управлению компонентами ОС

- WMI является надстройкой над WinAPI

WMI может использоваться:

- для сбора информации о статусе локальных и удаленных компьютерных систем
- настройки параметров безопасности для удаленных компьютеров и приложений
- настройки и редактирования свойств системы
- настройки и редактирования разрешений для авторизованных пользователей и групп
- выполнения кода и сериализации объектов (своеобразный «SSH на стероидах»)
- назначения и редактирования меток дисков
- создания графика выполнения процессов
- резервного копирования репозиториев объектов
- включения и отключения регистрации ошибок

Инструментарий WMI является частью операционной системы Windows, и он предварительно установлен на всех операционных системах, начиная с Windows 2000. WMI состоит из следующих компонентов:

- Служба WMI — это реализация системы WMI в Windows. Этот процесс отображается под именем «Инструментарий управления Windows» и является связующим звеном между поставщиками WMI, репозиторием WMI и управляющими приложениями. Данный процесс запускается автоматически при включении компьютера.

- Управляемые объекты — это любые логические или физические компоненты либо службы, которыми можно управлять с помощью WMI. К таким объектам могут относиться самые разные компоненты, поскольку WMI может получить доступ к любому параметру или объекту, к которым имеют доступ другие инструменты Windows, такие как системный монитор.

- Поставщики WMI — это объекты, которые отслеживают события и данные конкретного объекта. Существует множество различных типов поставщиков WMI как общего назначения, так и предназначенных для конкретных устройств. Многие из них предварительно встроены в систему Windows.

- Классы используются поставщиками WMI для передачи данных службам WMI. В классах содержатся события и свойства, позволяющие получать и настраивать данные. Системные классы WMI предварительно определены и начинаются с двойного подчеркивания.

- Методы, будучи привязанными к конкретным классам, позволяют выполнять действия на основе имеющихся в них данных. Например, методы можно использовать для запуска и завершения процессов на удаленных компьютерах. Доступ к методам можно получить с помощью приложений для обработки сценариев или сетевого администрирования.

- Репозиторий WMI — это база данных, в которой хранятся все статические данные, связанные с WMI. Динамические данные не хранятся в репозитории. Доступ к ним можно получить через класс поставщика WMI.

- Диспетчер объектов CMI — это система, которая находится между управляющим приложением и поставщиками WMI. Она запрашивает данные у этих поставщиков и затем передает их приложению.

API WMI выполняет эти операции и предоставляет приложениям доступ к инфраструктуре WMI без привязки к типу используемого устройства.

- Потребитель WMI — это сущность, которая отправляет запросы объектам через диспетчер объектов. Обычно потребитель WMI является приложением для мониторинга, таким как PRTG Network Monitor, управляющим приложением или сценарием PowerShell.

## Средства удаленной установки приложений

Сущесвтуют специальный приложения позволяющие удаленно устанавилвать приложения на компьютерах пользователей:

- Rinstall (только Windows)
- Rustdesk (Windows, Linux, macOS, Android)
- HelpWire
- Remote Installer (только Windows)
- Quick Assist (только Windows 10, 11)

#Administration #PowerShell #OS/Windows/WinRM